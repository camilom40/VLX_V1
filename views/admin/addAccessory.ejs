<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/_head.ejs') %>
  <title>Add New Accessory</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'DM Sans', sans-serif; background: linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 100%); }
    
    
    .main-card {
      background: white;
      border-radius: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 20px 25px -5px rgba(0,0,0,0.05);
      border: 1px solid rgba(226,232,240,0.8);
    }
    
    .form-section {
      background: linear-gradient(to right, #fafbfc, #fff);
      border-radius: 1rem;
      padding: 1.25rem;
      margin-bottom: 1rem;
      border: 1px solid #e2e8f0;
      transition: all 0.3s ease;
    }
    .form-section:hover { border-color: #cbd5e1; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    
    .section-icon {
      width: 2.25rem; height: 2.25rem;
      border-radius: 0.625rem;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
    }
    
    .form-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.75rem;
      border-radius: 0.625rem;
      border: 2px solid #e2e8f0;
      background: #f8fafc;
      color: #1e293b;
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }
    .form-input:hover { border-color: #cbd5e1; background: #fff; }
    .form-input:focus { outline: none; border-color: #3b82f6; background: #fff; box-shadow: 0 0 0 4px rgba(59,130,246,0.1); }
    
    .input-with-icon { position: relative; width: 100%; }
    .input-icon {
      position: absolute; left: 0.875rem; top: 50%; transform: translateY(-50%);
      color: #64748b; pointer-events: none; z-index: 10; transition: color 0.2s;
    }
    .input-with-icon:focus-within .input-icon { color: #3b82f6; }
    .input-icon svg { width: 1.125rem; height: 1.125rem; }
    
    select.form-input {
      appearance: none; cursor: pointer; padding-right: 2.5rem;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1.125rem;
    }
    
    .input-suffix {
      position: absolute; right: 0; top: 0; height: 100%;
      padding: 0 0.875rem; display: flex; align-items: center;
      background: linear-gradient(to right, #e2e8f0, #f1f5f9);
      color: #475569; font-weight: 600; font-size: 0.8rem;
      border-top-right-radius: 0.625rem; border-bottom-right-radius: 0.625rem;
      border: 2px solid #e2e8f0; border-left: none;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      color: white; font-weight: 600; padding: 0.75rem 1.75rem;
      border-radius: 0.625rem; box-shadow: 0 4px 14px rgba(59,130,246,0.4);
      transition: all 0.3s ease; display: inline-flex; align-items: center; gap: 0.5rem;
    }
    .btn-primary:hover { background: linear-gradient(135deg, #2563eb, #1d4ed8); box-shadow: 0 6px 20px rgba(59,130,246,0.5); transform: translateY(-2px); }
    
    .btn-secondary {
      background: #f1f5f9; color: #475569; font-weight: 600;
      padding: 0.75rem 1.25rem; border-radius: 0.625rem;
      border: 2px solid #e2e8f0; transition: all 0.3s ease;
      display: inline-flex; align-items: center; gap: 0.5rem;
    }
    .btn-secondary:hover { background: #e2e8f0; border-color: #cbd5e1; }
    
    .required-badge {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      color: #92400e; font-size: 0.6rem; font-weight: 700;
      padding: 0.2rem 0.4rem; border-radius: 0.3rem;
      margin-left: 0.4rem; text-transform: uppercase; letter-spacing: 0.05em;
    }
    
    .help-text { color: #64748b; font-size: 0.75rem; margin-top: 0.375rem; display: flex; align-items: center; gap: 0.25rem; }
    .error-message { color: #dc2626; font-size: 0.75rem; margin-top: 0.375rem; display: none; align-items: center; gap: 0.25rem; }
    
    .suggestion-card {
      background: linear-gradient(135deg, #f0fdf4, #dcfce7);
      border: 2px solid #86efac; border-radius: 1.25rem; padding: 1.25rem;
    }
    .suggestion-item {
      background: white; border-radius: 0.625rem; padding: 0.875rem;
      border: 1px solid #d1fae5; cursor: pointer; transition: all 0.3s ease;
    }
    .suggestion-item:hover { border-color: #34d399; box-shadow: 0 4px 12px rgba(52,211,153,0.2); transform: translateY(-2px); }
    .suggestion-item .icon { width: 2rem; height: 2rem; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; margin-bottom: 0.5rem; }
    
    .image-upload-area {
      border: 2px dashed #cbd5e1; border-radius: 0.875rem; padding: 1.5rem;
      text-align: center; background: linear-gradient(135deg, #f8fafc, #f1f5f9);
      cursor: pointer; transition: all 0.3s ease;
    }
    .image-upload-area:hover, .image-upload-area.active { border-color: #3b82f6; background: linear-gradient(135deg, #eff6ff, #dbeafe); }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <%- include('../partials/_header.ejs') %>

  <main class="flex-grow container mx-auto px-4 py-8">
    <!-- Page Header -->
    <div class="flex items-center justify-between mb-6">
      <div class="flex items-center gap-4">
        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
          </svg>
        </div>
        <div>
          <h1 class="text-2xl font-bold text-gray-800">Add New Accessory</h1>
          <p class="text-gray-500 text-sm">Create a new window system accessory</p>
        </div>
      </div>
      <a href="/admin/accessories" class="btn-secondary">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Back
      </a>
    </div>
    <div class="max-w-4xl mx-auto">
      <div class="main-card p-6 mb-5">
        <form id="createAccessoryForm" action="/admin/accessories/add" method="POST" enctype="multipart/form-data">
          <!-- Row 1: Name and Reference Number -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-2">
            <!-- Name field -->
            <div class="form-section !mb-0">
              <div class="flex items-center gap-2.5 mb-3">
                <div class="section-icon bg-blue-100 text-blue-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                  </svg>
                </div>
                <div>
                  <label for="name" class="font-semibold text-gray-800 text-sm">Accessory Name</label>
                  <span class="required-badge">Required</span>
                </div>
              </div>
              <div class="input-with-icon">
                <div class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                  </svg>
                </div>
                <input type="text" id="name" name="name" required class="form-input" 
                    placeholder="e.g., WindowHinge" maxlength="50" autocomplete="off">
              </div>
              <div id="nameError" class="error-message">
                <svg class="h-3.5 w-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/></svg>
                No spaces allowed
              </div>
              <p class="help-text">No spaces (e.g., CornerJoint)</p>
            </div>
            
            <!-- Reference Number field -->
            <div class="form-section !mb-0">
              <div class="flex items-center gap-2.5 mb-3">
                <div class="section-icon bg-indigo-100 text-indigo-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" />
                  </svg>
                </div>
                <div>
                  <label for="referenceNumber" class="font-semibold text-gray-800 text-sm">Reference Number</label>
                  <span class="required-badge">Required</span>
                </div>
              </div>
              <div class="input-with-icon">
                <div class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" />
                  </svg>
                </div>
                <input type="text" id="referenceNumber" name="referenceNumber" required class="form-input" 
                    placeholder="e.g., ACC-001" maxlength="50" autocomplete="off">
              </div>
              <div id="referenceNumberError" class="error-message">
                <svg class="h-3.5 w-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/></svg>
                Required field
              </div>
              <p class="help-text">e.g., WIN-HINGE-23</p>
            </div>
          </div>
          
          <!-- Row 2: Provider and Unit -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-2">
            <!-- Provider Name field -->
            <div class="form-section !mb-0">
              <div class="flex items-center gap-2.5 mb-3">
                <div class="section-icon bg-purple-100 text-purple-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                  </svg>
                </div>
                <div>
                  <label for="providerName" class="font-semibold text-gray-800 text-sm">Provider Company</label>
                  <span class="text-gray-400 text-xs ml-1.5">Optional</span>
                </div>
              </div>
              <div class="input-with-icon">
                <div class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                  </svg>
                </div>
                <input type="text" id="providerName" name="providerName" class="form-input" 
                    placeholder="Supplier name" maxlength="100" autocomplete="off">
              </div>
              <p class="help-text">Manufacturer or supplier</p>
            </div>
            
            <!-- Unit field -->
            <div class="form-section !mb-0">
              <div class="flex items-center gap-2.5 mb-3">
                <div class="section-icon bg-sky-100 text-sky-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4" />
                  </svg>
                </div>
                <div>
                  <label for="unit" class="font-semibold text-gray-800 text-sm">Unit Type</label>
                  <span class="required-badge">Required</span>
                </div>
              </div>
              <div class="flex gap-2">
                <div class="flex-1 input-with-icon">
                  <div class="input-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4" />
                    </svg>
                  </div>
                  <select id="unit" name="unit" required class="form-input">
                    <option value="">Select unit...</option>
                    <option value="piece">Piece</option>
                    <option value="meter">Meter</option>
                    <option value="set">Set</option>
                    <option value="pair">Pair</option>
                    <option value="kit">Kit</option>
                    <option value="roll">Roll</option>
                    <option value="sheet">Sheet</option>
                    <option value="custom">Custom...</option>
                  </select>
                </div>
                <div id="customUnitContainer" class="hidden">
                  <input type="text" id="customUnit" name="customUnit" class="form-input !pl-3" style="width: 90px;" placeholder="Unit">
                </div>
              </div>
              <p class="help-text">How this item is measured</p>
            </div>
          </div>
          
          <!-- Row 3: Price and Weight -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-2">
            <!-- Price field -->
            <div class="form-section !mb-0">
              <div class="flex items-center gap-2.5 mb-3">
                <div class="section-icon bg-emerald-100 text-emerald-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div>
                  <label for="price" class="font-semibold text-gray-800 text-sm">Price Per Unit</label>
                  <span class="required-badge">Required</span>
                </div>
              </div>
              <div class="flex gap-2">
                <div class="flex-1 input-with-icon">
                  <div class="input-icon">
                    <span class="text-base font-bold">$</span>
                  </div>
                  <input type="number" id="price" name="price" step="0.01" min="0" required 
                      class="form-input" placeholder="0.00">
                </div>
                <select id="currency" name="currency" required class="form-input !pl-3 !w-24">
                  <option value="COP">COP</option>
                  <option value="USD">USD</option>
                </select>
              </div>
              <div id="priceError" class="error-message">
                <svg class="h-3.5 w-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/></svg>
                Must be positive
              </div>
            </div>
            
            <!-- Weight field -->
            <div class="form-section !mb-0">
              <div class="flex items-center gap-2.5 mb-3">
                <div class="section-icon bg-amber-100 text-amber-600">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
                  </svg>
                </div>
                <div>
                  <label for="weight" class="font-semibold text-gray-800 text-sm">Weight</label>
                  <span class="text-gray-400 text-xs ml-1.5">Optional</span>
                </div>
              </div>
              <div class="input-with-icon">
                <div class="input-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
                  </svg>
                </div>
                <input type="number" id="weight" name="weight" step="0.01" min="0" class="form-input !pr-14" placeholder="0.00">
                <div class="input-suffix">kg</div>
              </div>
              <div id="weightError" class="error-message">
                <svg class="h-3.5 w-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/></svg>
                Must be positive
              </div>
            </div>
          </div>
          
          <!-- Image Upload field -->
          <div class="form-section">
            <div class="flex items-center gap-2.5 mb-3">
              <div class="section-icon bg-pink-100 text-pink-600">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
              </div>
              <div>
                <label class="font-semibold text-gray-800 text-sm">Accessory Image</label>
                <span class="text-gray-400 text-xs ml-1.5">Optional</span>
              </div>
            </div>
            <div id="imageUploadArea" class="image-upload-area">
              <input type="file" id="image" name="image" accept="image/*" class="hidden">
              <div id="uploadPrompt">
                <div class="w-14 h-14 mx-auto mb-3 rounded-xl bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center">
                  <svg class="h-7 w-7 text-blue-500" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </div>
                <p class="text-gray-600 text-sm mb-1">
                  <span class="font-semibold text-blue-600">Click to upload</span> or drag and drop
                </p>
                <p class="text-xs text-gray-400">PNG, JPG, JPEG up to 5MB</p>
              </div>
              <div id="imagePreview" class="hidden">
                <img id="previewImg" src="" alt="Preview" class="mx-auto max-h-36 rounded-lg shadow-lg">
                <p id="fileName" class="mt-2.5 text-sm text-gray-600 font-medium"></p>
                <button type="button" id="removeImage" class="mt-2 text-red-500 hover:text-red-700 text-sm font-medium inline-flex items-center gap-1">
                  <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                  </svg>
                  Remove
                </button>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="flex justify-between items-center pt-5 mt-5 border-t border-gray-100">
            <a href="/admin/accessories" class="btn-secondary">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
              Cancel
            </a>
            <button type="button" id="submitBtn" class="btn-primary">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
              </svg>
              Create Accessory
            </button>
          </div>
        </form>
      </div>
      
      <!-- Quick Fill Suggestions -->
      <div class="suggestion-card">
        <div class="flex items-center gap-2.5 mb-3">
          <div class="w-9 h-9 rounded-lg bg-emerald-500/20 flex items-center justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
          </div>
          <div>
            <h3 class="font-bold text-emerald-900 text-sm">Quick Fill Templates</h3>
            <p class="text-emerald-700 text-xs">Click to auto-fill with example values</p>
          </div>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-3 gap-2.5">
          <div class="suggestion-item" onclick="prefillForm('LockingHandle', 'piece', 55000, 0.25)">
            <div class="icon bg-blue-100">
              <svg class="h-4 w-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
              </svg>
            </div>
            <p class="font-semibold text-gray-800 text-xs">Hardware</p>
            <p class="text-xs text-gray-500">Handles, locks</p>
          </div>
          
          <div class="suggestion-item" onclick="prefillForm('WeatherStripSeal', 'meter', 15000, 0.1)">
            <div class="icon bg-cyan-100">
              <svg class="h-4 w-4 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"/>
              </svg>
            </div>
            <p class="font-semibold text-gray-800 text-xs">Weatherstrip</p>
            <p class="text-xs text-gray-500">Seals, gaskets</p>
          </div>
          
          <div class="suggestion-item" onclick="prefillForm('WindowTrim', 'set', 120000, 1.5)">
            <div class="icon bg-purple-100">
              <svg class="h-4 w-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6z"/>
              </svg>
            </div>
            <p class="font-semibold text-gray-800 text-xs">Finishing</p>
            <p class="text-xs text-gray-500">Trims, caps</p>
          </div>
          
          <div class="suggestion-item" onclick="prefillForm('ExtensionJamb', 'piece', 85000, 2.3)">
            <div class="icon bg-orange-100">
              <svg class="h-4 w-4 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"/>
              </svg>
            </div>
            <p class="font-semibold text-gray-800 text-xs">Jambs</p>
            <p class="text-xs text-gray-500">Extension jambs</p>
          </div>
          
          <div class="suggestion-item" onclick="prefillForm('ScreenMesh', 'roll', 150000, 0.75)">
            <div class="icon bg-green-100">
              <svg class="h-4 w-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
              </svg>
            </div>
            <p class="font-semibold text-gray-800 text-xs">Screens</p>
            <p class="text-xs text-gray-500">Mesh, frames</p>
          </div>
          
          <div class="suggestion-item" onclick="prefillForm('InstallationKit', 'kit', 65000, 0.5)">
            <div class="icon bg-red-100">
              <svg class="h-4 w-4 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
            </div>
            <p class="font-semibold text-gray-800 text-xs">Installation</p>
            <p class="text-xs text-gray-500">Screws, shims</p>
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <%- include('../partials/_footer.ejs') %>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const nameInput = document.getElementById('name');
      const nameError = document.getElementById('nameError');
      const priceInput = document.getElementById('price');
      const priceError = document.getElementById('priceError');
      const weightInput = document.getElementById('weight');
      const weightError = document.getElementById('weightError');
      const unitSelect = document.getElementById('unit');
      const customUnitContainer = document.getElementById('customUnitContainer');
      const customUnitInput = document.getElementById('customUnit');
      const form = document.getElementById('createAccessoryForm');
      const submitBtn = document.getElementById('submitBtn');
      const referenceNumberInput = document.getElementById('referenceNumber');
      const referenceNumberError = document.getElementById('referenceNumberError');
      
      // Image upload elements
      const imageInput = document.getElementById('image');
      const imageUploadArea = document.getElementById('imageUploadArea');
      const uploadPrompt = document.getElementById('uploadPrompt');
      const imagePreview = document.getElementById('imagePreview');
      const previewImg = document.getElementById('previewImg');
      const fileName = document.getElementById('fileName');
      const removeImageBtn = document.getElementById('removeImage');
      
      // Handle custom unit selection
      unitSelect.addEventListener('change', function() {
        if (this.value === 'custom') {
          customUnitContainer.classList.remove('hidden');
          customUnitInput.required = true;
          customUnitInput.focus();
        } else {
          customUnitContainer.classList.add('hidden');
          customUnitInput.required = false;
        }
      });
      
      // Validation listeners
      nameInput.addEventListener('input', validateName);
      referenceNumberInput.addEventListener('input', validateReferenceNumber);
      priceInput.addEventListener('input', validatePrice);
      weightInput.addEventListener('input', validateWeight);
      
      // Image upload handling
      imageUploadArea.addEventListener('click', () => imageInput.click());
      
      imageUploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        imageUploadArea.classList.add('active');
      });
      
      imageUploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        imageUploadArea.classList.remove('active');
      });
      
      imageUploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        imageUploadArea.classList.remove('active');
        if (e.dataTransfer.files.length > 0) {
          handleImageFile(e.dataTransfer.files[0]);
        }
      });
      
      imageInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
          handleImageFile(e.target.files[0]);
        }
      });
      
      removeImageBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        imageInput.value = '';
        uploadPrompt.classList.remove('hidden');
        imagePreview.classList.add('hidden');
        imageUploadArea.classList.remove('active');
      });
      
      function handleImageFile(file) {
        if (!file.type.startsWith('image/')) {
          alert('Please select an image file');
          return;
        }
        
        if (file.size > 5 * 1024 * 1024) {
          alert('Image size must be less than 5MB');
          return;
        }
        
        const reader = new FileReader();
        reader.onload = (e) => {
          previewImg.src = e.target.result;
          fileName.textContent = file.name;
          uploadPrompt.classList.add('hidden');
          imagePreview.classList.remove('hidden');
          imageUploadArea.classList.add('active');
        };
        reader.readAsDataURL(file);
      }
      
      // Form submission
      submitBtn.addEventListener('click', function(e) {
        e.preventDefault();
        
        const nameValue = nameInput.value.trim();
        const refValue = referenceNumberInput.value.trim();
        const priceValue = priceInput.value;
        const unitValue = unitSelect.value;
        
        if (!nameValue) {
          alert('Please enter an accessory name');
          nameInput.focus();
          return;
        }
        
        if (/\s/.test(nameValue)) {
          alert('Accessory name cannot contain spaces');
          nameInput.focus();
          return;
        }
        
        if (!refValue) {
          alert('Please enter a reference number');
          referenceNumberInput.focus();
          return;
        }
        
        if (!priceValue || parseFloat(priceValue) < 0) {
          alert('Please enter a valid price');
          priceInput.focus();
          return;
        }
        
        if (!unitValue) {
          alert('Please select a unit type');
          unitSelect.focus();
          return;
        }
        
        if (unitValue === 'custom' && !customUnitInput.value.trim()) {
          alert('Please enter a custom unit');
          customUnitInput.focus();
          return;
        }
        
        // Show loading state
        submitBtn.innerHTML = '<svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Creating...';
        submitBtn.disabled = true;
        
        form.submit();
      });
      
      function validateName() {
        const name = nameInput.value.trim();
        if (/\s/.test(name)) {
          nameError.style.display = 'flex';
          nameInput.style.borderColor = '#f87171';
          return false;
        } else {
          nameError.style.display = 'none';
          nameInput.style.borderColor = '';
          return true;
        }
      }
      
      function validateReferenceNumber() {
        const refNumber = referenceNumberInput.value.trim();
        if (refNumber.length === 0) {
          referenceNumberError.style.display = 'flex';
          referenceNumberInput.style.borderColor = '#f87171';
          return false;
        } else {
          referenceNumberError.style.display = 'none';
          referenceNumberInput.style.borderColor = '';
          return true;
        }
      }
      
      function validatePrice() {
        const price = parseFloat(priceInput.value);
        if (priceInput.value && (isNaN(price) || price < 0)) {
          priceError.style.display = 'flex';
          priceInput.style.borderColor = '#f87171';
          return false;
        } else {
          priceError.style.display = 'none';
          priceInput.style.borderColor = '';
          return true;
        }
      }
      
      function validateWeight() {
        if (weightInput.value.trim() === '') {
          weightError.style.display = 'none';
          weightInput.style.borderColor = '';
          return true;
        }
        
        const weight = parseFloat(weightInput.value);
        if (isNaN(weight) || weight < 0) {
          weightError.style.display = 'flex';
          weightInput.style.borderColor = '#f87171';
          return false;
        } else {
          weightError.style.display = 'none';
          weightInput.style.borderColor = '';
          return true;
        }
      }
    });
    
    // Function to prefill the form
    function prefillForm(name, unit, price, weight) {
      const nameInput = document.getElementById('name');
      const unitSelect = document.getElementById('unit');
      const priceInput = document.getElementById('price');
      const weightInput = document.getElementById('weight');
      const customUnitContainer = document.getElementById('customUnitContainer');
      const customUnitInput = document.getElementById('customUnit');
      
      // Animate fields with green highlight
      [nameInput, unitSelect, priceInput, weightInput].forEach(el => {
        el.style.transition = 'all 0.3s ease';
        el.style.boxShadow = '0 0 0 3px rgba(52, 211, 153, 0.4)';
        setTimeout(() => el.style.boxShadow = '', 800);
      });
      
      nameInput.value = name;
      
      // Handle both standard and custom units
      if (['piece', 'set', 'meter', 'roll', 'box', 'pair', 'kit', 'sheet'].includes(unit)) {
        unitSelect.value = unit;
        customUnitContainer.classList.add('hidden');
        customUnitInput.required = false;
      } else {
        unitSelect.value = 'custom';
        customUnitContainer.classList.remove('hidden');
        customUnitInput.value = unit;
        customUnitInput.required = true;
      }
      
      priceInput.value = price;
      weightInput.value = weight;
      
      // Scroll to form
      document.querySelector('.main-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  </script>
</body>
</html>
